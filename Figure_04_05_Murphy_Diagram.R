library(tsutils)
library(PMCMRplus)
library(vioplot)
library(greybox)
library(MTS)
library(dplyr)
library(murphydiagram)

par(mfrow = c(1,1), mfcol = c(1,1))
par(mgp = c(3, 1, 0))
par(mar = c(5.1, 4.1, 4.1, 2.1))

##################################################### Murphy Diagrams ##################################################### 
test.data.24M <- c(244.3479261, 95.08021794, 326.1647915, 259.7489046, 411.2888056, 266.2633128, 209.0009394, 221.277325, 229.6155689, 225.9682532, 235.5590969, 189.2958277, 336.7758492, 255.6456167, 178.5962387, 204.4393112, 220.3033416, 198.4815688, 213.5660193, 242.0564097, 287.5295264, 226.2019158, 227.9405454, 218.04583)
ARIMA <- c(183.8729174, 186.0546543, 186.7236874, 186.9288474, 186.9917601, 187.0110523, 187.0169683, 187.0187825, 187.0193388, 187.0195094, 187.0195617, 187.0195777, 187.0195827, 187.0195842, 187.0195846, 187.0195848, 187.0195848, 187.0195848, 187.0195848, 187.0195848, 187.0195848, 187.0195848, 187.0195848, 187.0195848)
BSTS <- c(176.8939257, 177.4979012, 193.8511098, 191.2024125, 202.425199, 204.3622976, 196.7810599, 199.5958182, 194.5109462, 191.4379963, 196.8030567, 199.242143, 188.1250353, 191.0256089, 204.3898829, 197.2043361, 210.6621776, 210.7026249, 205.4722445, 209.158696, 203.7027408, 197.4885985, 204.9457187, 208.0710849)
BSTSx <- c(177.3924128, 181.5088835, 197.6019996, 198.8833678, 220.2363725, 207.2356609, 202.4024704, 211.0657973, 213.4604949, 207.0273587, 209.8074902, 203.4815917, 191.1275718, 198.1274478, 212.8690934, 206.4522786, 223.2927986, 218.4205927, 212.073341, 222.3125006, 215.6957817, 206.8797228, 217.964665, 215.4588285)
tml <- as.numeric(substr(c("2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01"), 1, 4))
df <- data.frame("Date" = tml, "Actual" = test.data.24M, "BSTSx" = BSTSx, "ARIMA" = ARIMA, "BSTS" = BSTS)

murphydiagram(BSTSx , BSTS, df$Actual, labels = c("BSTSx", "BSTS"))
title(main = "Murphy Diagram") 

murphydiagram_diff(BSTSx , BSTS, df$Actual, lag_truncate = 1, conf_level = 0.95)
title(main = "Murphy Difference Diagram: BSTSx - BSTSx")

murphydiagram(BSTSx , ARIMA, df$Actual, labels = c("BSTSx", "ARIMA"))
title(main = "Murphy Diagram") 

murphydiagram_diff(BSTSx , ARIMA, df$Actual, lag_truncate = 1, conf_level = 0.95)
title(main = "Murphy Difference Diagram: BSTSx - ARIMA") 
