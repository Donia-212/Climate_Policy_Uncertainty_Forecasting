library(tsutils)
library(PMCMRplus)
library(vioplot)
library(greybox)
library(MTS)
library(dplyr)
library(murphydiagram)

par(mfrow = c(1,1), mfcol = c(1,1))
par(mgp = c(3, 1, 0))
par(mar = c(5.1, 4.1, 4.1, 2.1))



##################################################### Murphy Diagrams: Primary US ##################################################### 

test.data.24M <- c(244.3479261, 95.08021794, 326.1647915, 259.7489046, 411.2888056, 266.2633128, 209.0009394, 221.277325, 229.6155689, 225.9682532, 235.5590969, 189.2958277, 336.7758492, 255.6456167, 178.5962387, 204.4393112, 220.3033416, 198.4815688, 213.5660193, 242.0564097, 287.5295264, 226.2019158, 227.9405454, 218.04583)
ARIMAXMG <- c(177.0526162, 156.1024854, 185.4355683, 154.4632324, 148.5021324, 157.816673, 147.0391027, 173.8021553, 158.0975301, 205.6274996, 177.2566941, 230.057955, 173.4130361, 129.354729, 180.7009247, 186.3244595, 207.8520377, 189.2262873, 186.243788, 183.6988915, 186.4998783, 200.5875905, 164.8209679, 200.8177525)
BSTSXM <- c(177.5282154, 176.8211306, 191.9118957, 188.4285757, 200.678603, 203.2236961, 193.7676299, 197.9653762, 191.2967369, 186.8132284, 194.2912977, 197.5226183, 184.8264451, 189.0492963, 202.3666145, 193.7931991, 205.0599665, 206.4560799, 198.8761242, 204.2732957, 200.8016842, 193.6722991, 201.4868815, 204.9765182)
BSTSXMG <- c(177.3924128, 181.5088835, 197.6019996, 198.8833678, 220.2363725, 207.2356609, 202.4024704, 211.0657973, 213.4604949, 207.0273587, 209.8074902, 203.4815917, 191.1275718, 198.1274478, 212.8690934, 206.4522786, 223.2927986, 218.4205927, 212.073341, 222.3125006, 215.6957817, 206.8797228, 217.964665, 215.4588285)
tml <- as.numeric(substr(c("2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01"), 1, 4))
df <- data.frame("Date" = tml, "Actual" = test.data.24M, "BSTSXMG" = BSTSXMG, "ARIMAXMG" = ARIMAXMG, "BSTSXM" = BSTSXM)

murphydiagram(BSTSXMG , BSTSXM, df$Actual, labels = c("BSTSXMG", "BSTSXM"))
title(main = "Murphy Diagram") 

murphydiagram(BSTSXMG , ARIMAXMG, df$Actual, labels = c("BSTSXMG", "ARIMAXMG"))
title(main = "Murphy Diagram") 



##################################################### Murphy Diagrams: Alternate US ##################################################### 

test.data.24M <- c(2.278446514, 4.358034164, 4.347389234, 5.955523526, 4.161053193, 5.751748812, 3.104076718, 1.459061149, 4.116369122, 1.523123989, 2.90924166, 2.387099185, 1.258927366, 3.216425014, 2.643508128, 3.101454146, 2.326090609, 1.550727073, 2.718446286, 2.167341881, 1.691293993, 2.297268009, 2.326090609, 1.351297644)
ARIMAXMG <- c(1.2747225, 1.8616291, 1.3177155, 1.4692086, 1.371264, 1.8079501, 1.4702672, 0.8338439, 1.1403366, 0.8912687, 1.1317464, 0.3115766, 0.3464562, 1.2710146, 1.1065386, 0.3270078, -0.2529881, 1.6362487, 1.5430314, 1.5092139, 1.6927723, 2.0073452, 2.338652, 2.8919653)
BSTSXM <- c(2.021060963, 2.069654522, 2.003004093, 2.179233141, 2.011902878, 2.314464502, 2.172420728, 1.852909583, 1.626142106, 1.634587583, 1.693128379, 2.061693404, 1.699187836, 1.847454001, 1.740335274, 1.92490478, 1.846190083, 2.230317966, 2.159586783, 1.946873381, 1.760247178, 1.833188393, 1.879431483, 2.215731932)
BSTSXMG <- c(2.18190231, 2.2486162, 2.168818868, 2.358335278, 2.200296522, 2.522217741, 2.394222733, 2.193485875, 1.952425607, 1.987897773, 2.019164976, 2.385311927, 2.044649261, 2.19113566, 2.143722129, 2.313890113, 2.138522526, 2.483108768, 2.36456497, 2.135059227, 1.905939199, 1.956198932, 1.997840808, 2.40387078)
tml <- as.numeric(substr(c("2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01", "2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01", "2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01", "2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01"), 1, 4))
df <- data.frame("Date" = tml, "Actual" = test.data.24M, "BSTSXMG" = BSTSXMG, "ARIMAXMG" = ARIMAXMG, "BSTSXM" = BSTSXM)

murphydiagram(BSTSXMG , BSTSXM, df$Actual, labels = c("BSTSXMG", "BSTSXM"))
title(main = "Murphy Diagram") 

murphydiagram(BSTSXMG , ARIMAXMG, df$Actual, labels = c("BSTSXMG", "ARIMAXMG"))
title(main = "Murphy Diagram") 



##################################################### Murphy Diagrams: Global ##################################################### 

test.data.24M <- c(122.7038833, 197.1345231, 217.3154434, 234.2989455, 224.8630497, 267.0980286, 189.3277423, 104.5560909, 212.0369817, 131.1486071, 219.0280343, 170.5562522, 128.4827531, 164.305957, 158.6153943, 180.9709193, 136.6155465, 152.0931417, 200.101263, 176.657224, 202.4812321, 171.0520984, 148.4954443, 134.8802609)
ARIMAXMG <- c(139.4069628, 138.8375758, 138.6313928, 138.4946481, 138.379743, 138.2780335, 138.1871377, 138.1057676, 138.032903, 137.9676515, 137.909217, 137.8568873, 137.8100246, 137.7680577, 137.7304752, 137.696819, 137.6666789, 137.6396877, 137.6155162, 137.59387, 137.5744852, 137.5571256, 137.5415795, 137.5276576)
BSTSXM <- c(140.093061, 141.1814844, 149.7238168, 148.5687143, 153.5722566, 155.6268391, 154.8245005, 135.633227, 141.3858652, 138.3504397, 142.8898926, 152.5122637, 148.4500761, 149.4747037, 158.8987605, 153.4484576, 158.9012442, 161.106074, 159.6611431, 145.1440589, 148.961118, 146.9164099, 148.6240235, 160.8085408)
BSTSXMG <- c(140.3326, 141.7019, 150.2244, 149.0329, 153.6851, 155.6435, 155.4023, 136.6127, 142.1125, 139.3068, 143.7365, 153.122, 148.9986, 150.1982, 159.4868, 154.0637, 159.466, 161.4443, 160.0616, 146.0814, 148.994, 147.3614, 148.9878, 161.2029)

tml <- as.numeric(substr(c("2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01", "2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01", "2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01", "2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01"), 1, 4))
df <- data.frame("Date" = tml, "Actual" = test.data.24M, "BSTSXMG" = BSTSXMG, "ARIMAXMG" = ARIMAXMG, "BSTSXM" = BSTSXM)

murphydiagram(BSTSXMG , BSTSXM, df$Actual, labels = c("BSTSXMG", "BSTSXM"))
title(main = "Murphy Diagram") 

murphydiagram(BSTSXMG , ARIMAXMG, df$Actual, labels = c("BSTSXMG", "ARIMAXMG"))
title(main = "Murphy Diagram") 
