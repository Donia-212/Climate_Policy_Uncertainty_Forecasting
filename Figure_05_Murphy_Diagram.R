library(tsutils)
library(PMCMRplus)
library(vioplot)
library(greybox)
library(MTS)
library(dplyr)
library(murphydiagram)

par(mfrow = c(1,1), mfcol = c(1,1))
par(mgp = c(3, 1, 0))
par(mar = c(5.1, 4.1, 4.1, 2.1))

##################################################### Murphy Diagrams ##################################################### 
test.data.24M <- c(244.3479261, 95.08021794, 326.1647915, 259.7489046, 411.2888056, 266.2633128, 209.0009394, 221.277325, 229.6155689, 225.9682532, 235.5590969, 189.2958277, 336.7758492, 255.6456167, 178.5962387, 204.4393112, 220.3033416, 198.4815688, 213.5660193, 242.0564097, 287.5295264, 226.2019158, 227.9405454, 218.04583)
NLinearXM <- c(127.2848618, 89.09128913, 158.2180479, 128.1684392, 123.019865, 130.9641491, 177.8604349, 198.9745829, 236.0369507, 267.2016613, 256.5727047, 249.1733047, 221.4600959, 216.7555215, 199.5859797, 208.3192898, 254.7798682, 317.2205766, 284.3113182, 243.8690595, 224.123106, 249.7720956, 275.7050877, 273.8299367)
BSTSXM <- c(177.5282154, 176.8211306, 191.9118957, 188.4285757, 200.678603, 203.2236961, 193.7676299, 197.9653762, 191.2967369, 186.8132284, 194.2912977, 197.5226183, 184.8264451, 189.0492963, 202.3666145, 193.7931991, 205.0599665, 206.4560799, 198.8761242, 204.2732957, 200.8016842, 193.6722991, 201.4868815, 204.9765182)
BSTSXMG <- c(177.3924128, 181.5088835, 197.6019996, 198.8833678, 220.2363725, 207.2356609, 202.4024704, 211.0657973, 213.4604949, 207.0273587, 209.8074902, 203.4815917, 191.1275718, 198.1274478, 212.8690934, 206.4522786, 223.2927986, 218.4205927, 212.073341, 222.3125006, 215.6957817, 206.8797228, 217.964665, 215.4588285)
tml <- as.numeric(substr(c("2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01"), 1, 4))
df <- data.frame("Date" = tml, "Actual" = test.data.24M, "BSTSXMG" = BSTSxMG, "NLinearXM" = NLinearXM, "BSTSXM" = BSTSXM)

murphydiagram(BSTSXMG , BSTSXM, df$Actual, labels = c("BSTSXMG", "BSTSXM"))
title(main = "Murphy Diagram") 


murphydiagram(BSTSXMG , NLinearXM, df$Actual, labels = c("BSTSXMG", "NLinearXM"))
title(main = "Murphy Diagram") 
